{"version":3,"sources":["vs/languages/handlebars/common/fake","vs/languages/handlebars/common/handlebars.js","vs/languages/handlebars/common/file:/home/aeschli/workspaces/vscode/src/vs/languages/handlebars/common/handlebarsTokenTypes.ts","vs/languages/handlebars/common/file:/home/aeschli/workspaces/vscode/src/vs/languages/handlebars/common/handlebars.ts"],"names":["__m","__M","deps","result","i","len","length","define","require","exports","EMBED","EMBED_UNESCAPED","KEYWORD","VARIABLE","__extends","this","d","b","__","constructor","p","hasOwnProperty","prototype","Object","create","__decorate","decorators","target","key","desc","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","modes","htmlMode","handlebarsTokenTypes","instantiation_1","modeService_1","languageConfigurationRegistry_1","abstractMode_1","async_1","compatWorkerService_1","States","HandlebarsState","_super","mode","kind","handlebarsKind","lastTagName","lastAttributeName","embeddedContentType","attributeValueQuote","attributeValue","call","makeClone","getMode","equals","other","tokenize","stream","HTML","advanceIfString","UnescapedExpression","type","Expression","skipWhitespace","peek","advanceWhile","next","goBack","State","HandlebarsMode","descriptor","instantiationService","modeService","compatWorkerService","_registerSupports","_this","SuggestRegistry","register","getId","triggerCharacters","shouldAutotriggerSuggest","provideCompletionItems","model","position","token","wireCancellationToken","_provideCompletionItems","uri","DocumentHighlightProviderRegistry","provideDocumentHighlights","_provideDocumentHighlights","LinkProviderRegistry","provideLinks","_provideLinks","LanguageConfigurationRegistry","LANG_CONFIG","getInitialState","Content","getLeavingNestedModeData","line","state","leavingNestedModeData","stateAfterNestedMode","wordPattern","createWordRegExp","comments","blockComment","brackets","__electricCharacterSupport","embeddedElectricCharacters","autoClosingPairs","open","close","surroundingPairs","onEnterRules","beforeText","RegExp","EMPTY_ELEMENTS","join","afterText","action","indentAction","IndentAction","IndentOutdent","Indent","IInstantiationService","IModeService","ICompatWorkerService","HTMLMode"],"mappings":"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","file":"vs/languages/handlebars/common/handlebars.js","sourcesContent":["}).call(this);","/*!-----------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.5.3(793ede49d53dba79d39e52205f16321278f5183c)\n * Released under the MIT license\n * https://github.com/Microsoft/vscode/blob/master/LICENSE.txt\n *-----------------------------------------------------------*/\n\n(function() {\nvar __m = [\"vs/languages/handlebars/common/handlebarsTokenTypes\",\"exports\",\"require\",\"vs/languages/handlebars/common/handlebars\",\"vs/editor/common/modes\",\"vs/languages/html/common/html\",\"vs/editor/common/services/compatWorkerService\",\"vs/editor/common/services/modeService\",\"vs/editor/common/modes/languageConfigurationRegistry\",\"vs/editor/common/modes/abstractMode\",\"vs/base/common/async\",\"vs/platform/instantiation/common/instantiation\"];\nvar __M = function(deps) {\n  var result = [];\n  for (var i = 0, len = deps.length; i < len; i++) {\n    result[i] = __m[deps[i]];\n  }\n  return result;\n};\ndefine(__m[0], __M([2,1]), function (require, exports) {\n    /*---------------------------------------------------------------------------------------------\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\n     *--------------------------------------------------------------------------------------------*/\n    'use strict';\n    exports.EMBED = 'punctuation.expression.unescaped.handlebars';\n    exports.EMBED_UNESCAPED = 'punctuation.expression.handlebars';\n    exports.KEYWORD = 'keyword.helper.handlebars';\n    exports.VARIABLE = 'variable.parameter.handlebars';\n});\n\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\ndefine(__m[3], __M([2,1,4,5,0,11,7,8,9,10,6]), function (require, exports, modes, htmlMode, handlebarsTokenTypes, instantiation_1, modeService_1, languageConfigurationRegistry_1, abstractMode_1, async_1, compatWorkerService_1) {\n    /*---------------------------------------------------------------------------------------------\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\n     *--------------------------------------------------------------------------------------------*/\n    'use strict';\n    (function (States) {\n        States[States[\"HTML\"] = 0] = \"HTML\";\n        States[States[\"Expression\"] = 1] = \"Expression\";\n        States[States[\"UnescapedExpression\"] = 2] = \"UnescapedExpression\";\n    })(exports.States || (exports.States = {}));\n    var States = exports.States;\n    var HandlebarsState = (function (_super) {\n        __extends(HandlebarsState, _super);\n        function HandlebarsState(mode, kind, handlebarsKind, lastTagName, lastAttributeName, embeddedContentType, attributeValueQuote, attributeValue) {\n            _super.call(this, mode, kind, lastTagName, lastAttributeName, embeddedContentType, attributeValueQuote, attributeValue);\n            this.kind = kind;\n            this.handlebarsKind = handlebarsKind;\n            this.lastTagName = lastTagName;\n            this.lastAttributeName = lastAttributeName;\n            this.embeddedContentType = embeddedContentType;\n            this.attributeValueQuote = attributeValueQuote;\n            this.attributeValue = attributeValue;\n        }\n        HandlebarsState.prototype.makeClone = function () {\n            return new HandlebarsState(this.getMode(), this.kind, this.handlebarsKind, this.lastTagName, this.lastAttributeName, this.embeddedContentType, this.attributeValueQuote, this.attributeValue);\n        };\n        HandlebarsState.prototype.equals = function (other) {\n            if (other instanceof HandlebarsState) {\n                return (_super.prototype.equals.call(this, other));\n            }\n            return false;\n        };\n        HandlebarsState.prototype.tokenize = function (stream) {\n            switch (this.handlebarsKind) {\n                case States.HTML:\n                    if (stream.advanceIfString('{{{').length > 0) {\n                        this.handlebarsKind = States.UnescapedExpression;\n                        return { type: handlebarsTokenTypes.EMBED_UNESCAPED };\n                    }\n                    else if (stream.advanceIfString('{{').length > 0) {\n                        this.handlebarsKind = States.Expression;\n                        return { type: handlebarsTokenTypes.EMBED };\n                    }\n                    break;\n                case States.Expression:\n                case States.UnescapedExpression:\n                    if (this.handlebarsKind === States.Expression && stream.advanceIfString('}}').length > 0) {\n                        this.handlebarsKind = States.HTML;\n                        return { type: handlebarsTokenTypes.EMBED };\n                    }\n                    else if (this.handlebarsKind === States.UnescapedExpression && stream.advanceIfString('}}}').length > 0) {\n                        this.handlebarsKind = States.HTML;\n                        return { type: handlebarsTokenTypes.EMBED_UNESCAPED };\n                    }\n                    else if (stream.skipWhitespace().length > 0) {\n                        return { type: '' };\n                    }\n                    if (stream.peek() === '#') {\n                        stream.advanceWhile(/^[^\\s}]/);\n                        return { type: handlebarsTokenTypes.KEYWORD };\n                    }\n                    if (stream.peek() === '/') {\n                        stream.advanceWhile(/^[^\\s}]/);\n                        return { type: handlebarsTokenTypes.KEYWORD };\n                    }\n                    if (stream.advanceIfString('else')) {\n                        var next = stream.peek();\n                        if (next === ' ' || next === '\\t' || next === '}') {\n                            return { type: handlebarsTokenTypes.KEYWORD };\n                        }\n                        else {\n                            stream.goBack(4);\n                        }\n                    }\n                    if (stream.advanceWhile(/^[^\\s}]/).length > 0) {\n                        return { type: handlebarsTokenTypes.VARIABLE };\n                    }\n                    break;\n            }\n            return _super.prototype.tokenize.call(this, stream);\n        };\n        return HandlebarsState;\n    }(htmlMode.State));\n    exports.HandlebarsState = HandlebarsState;\n    var HandlebarsMode = (function (_super) {\n        __extends(HandlebarsMode, _super);\n        function HandlebarsMode(descriptor, instantiationService, modeService, compatWorkerService) {\n            _super.call(this, descriptor, instantiationService, modeService, compatWorkerService);\n        }\n        HandlebarsMode.prototype._registerSupports = function () {\n            var _this = this;\n            modes.SuggestRegistry.register(this.getId(), {\n                triggerCharacters: ['.', ':', '<', '\"', '=', '/'],\n                shouldAutotriggerSuggest: true,\n                provideCompletionItems: function (model, position, token) {\n                    return async_1.wireCancellationToken(token, _this._provideCompletionItems(model.uri, position));\n                }\n            }, true);\n            modes.DocumentHighlightProviderRegistry.register(this.getId(), {\n                provideDocumentHighlights: function (model, position, token) {\n                    return async_1.wireCancellationToken(token, _this._provideDocumentHighlights(model.uri, position));\n                }\n            }, true);\n            modes.LinkProviderRegistry.register(this.getId(), {\n                provideLinks: function (model, token) {\n                    return async_1.wireCancellationToken(token, _this._provideLinks(model.uri));\n                }\n            }, true);\n            languageConfigurationRegistry_1.LanguageConfigurationRegistry.register(this.getId(), HandlebarsMode.LANG_CONFIG);\n        };\n        HandlebarsMode.prototype.getInitialState = function () {\n            return new HandlebarsState(this, htmlMode.States.Content, States.HTML, '', '', '', '', '');\n        };\n        HandlebarsMode.prototype.getLeavingNestedModeData = function (line, state) {\n            var leavingNestedModeData = _super.prototype.getLeavingNestedModeData.call(this, line, state);\n            if (leavingNestedModeData) {\n                leavingNestedModeData.stateAfterNestedMode = new HandlebarsState(this, htmlMode.States.Content, States.HTML, '', '', '', '', '');\n            }\n            return leavingNestedModeData;\n        };\n        HandlebarsMode.LANG_CONFIG = {\n            wordPattern: abstractMode_1.createWordRegExp('#-?%'),\n            comments: {\n                blockComment: ['<!--', '-->']\n            },\n            brackets: [\n                ['<!--', '-->'],\n                ['{{', '}}']\n            ],\n            __electricCharacterSupport: {\n                embeddedElectricCharacters: ['*', '}', ']', ')']\n            },\n            autoClosingPairs: [\n                { open: '{', close: '}' },\n                { open: '[', close: ']' },\n                { open: '(', close: ')' },\n                { open: '\"', close: '\"' },\n                { open: '\\'', close: '\\'' }\n            ],\n            surroundingPairs: [\n                { open: '<', close: '>' },\n                { open: '\"', close: '\"' },\n                { open: '\\'', close: '\\'' }\n            ],\n            onEnterRules: [\n                {\n                    beforeText: new RegExp(\"<(?!(?:\" + htmlMode.EMPTY_ELEMENTS.join('|') + \"))(\\\\w[\\\\w\\\\d]*)([^/>]*(?!/)>)[^<]*$\", 'i'),\n                    afterText: /^<\\/(\\w[\\w\\d]*)\\s*>$/i,\n                    action: { indentAction: modes.IndentAction.IndentOutdent }\n                },\n                {\n                    beforeText: new RegExp(\"<(?!(?:\" + htmlMode.EMPTY_ELEMENTS.join('|') + \"))(\\\\w[\\\\w\\\\d]*)([^/>]*(?!/)>)[^<]*$\", 'i'),\n                    action: { indentAction: modes.IndentAction.Indent }\n                }\n            ],\n        };\n        HandlebarsMode = __decorate([\n            __param(1, instantiation_1.IInstantiationService),\n            __param(2, modeService_1.IModeService),\n            __param(3, compatWorkerService_1.ICompatWorkerService)\n        ], HandlebarsMode);\n        return HandlebarsMode;\n    }(htmlMode.HTMLMode));\n    exports.HandlebarsMode = HandlebarsMode;\n});\n\n}).call(this);\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nexport const EMBED = 'punctuation.expression.unescaped.handlebars';\nexport const EMBED_UNESCAPED = 'punctuation.expression.handlebars';\nexport const KEYWORD = 'keyword.helper.handlebars';\nexport const VARIABLE = 'variable.parameter.handlebars';","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport modes = require('vs/editor/common/modes');\nimport htmlMode = require('vs/languages/html/common/html');\nimport handlebarsTokenTypes = require('vs/languages/handlebars/common/handlebarsTokenTypes');\nimport htmlWorker = require('vs/languages/html/common/htmlWorker');\nimport {IInstantiationService} from 'vs/platform/instantiation/common/instantiation';\nimport {IModeService} from 'vs/editor/common/services/modeService';\nimport {LanguageConfigurationRegistry, LanguageConfiguration} from 'vs/editor/common/modes/languageConfigurationRegistry';\nimport {createWordRegExp} from 'vs/editor/common/modes/abstractMode';\nimport {ILeavingNestedModeData} from 'vs/editor/common/modes/supports/tokenizationSupport';\nimport {wireCancellationToken} from 'vs/base/common/async';\nimport {ICompatWorkerService} from 'vs/editor/common/services/compatWorkerService';\n\nexport enum States {\n\tHTML,\n\tExpression,\n\tUnescapedExpression\n}\n\nexport class HandlebarsState extends htmlMode.State {\n\n\tconstructor(mode:modes.IMode,\n\t\tpublic kind:htmlMode.States,\n\t\tpublic handlebarsKind:States,\n\t\tpublic lastTagName:string,\n\t\tpublic lastAttributeName:string,\n\t\tpublic embeddedContentType:string,\n\t\tpublic attributeValueQuote:string,\n\t\tpublic attributeValue:string) {\n\n\t\tsuper(mode, kind, lastTagName, lastAttributeName, embeddedContentType, attributeValueQuote, attributeValue);\n\t}\n\n\tpublic makeClone(): HandlebarsState {\n\t\treturn new HandlebarsState(this.getMode(), this.kind, this.handlebarsKind, this.lastTagName, this.lastAttributeName, this.embeddedContentType, this.attributeValueQuote, this.attributeValue);\n\t}\n\n\tpublic equals(other:modes.IState):boolean {\n\t\tif (other instanceof HandlebarsState) {\n\t\t\treturn (\n\t\t\t\tsuper.equals(other)\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic tokenize(stream:modes.IStream) : modes.ITokenizationResult {\n\t\tswitch(this.handlebarsKind) {\n\t\t\tcase States.HTML:\n\t\t\t\tif (stream.advanceIfString('{{{').length > 0) {\n\t\t\t\t\tthis.handlebarsKind = States.UnescapedExpression;\n\t\t\t\t\treturn { type: handlebarsTokenTypes.EMBED_UNESCAPED };\n\t\t\t\t}\n\t\t\t\telse if (stream.advanceIfString('{{').length > 0) {\n\t\t\t\t\tthis.handlebarsKind = States.Expression;\n\t\t\t\t\treturn { type: handlebarsTokenTypes.EMBED };\n\t\t\t\t}\n\t\t\tbreak;\n\n\t\t\tcase States.Expression:\n\t\t\tcase States.UnescapedExpression:\n\t\t\t\tif (this.handlebarsKind === States.Expression && stream.advanceIfString('}}').length > 0) {\n\t\t\t\t\tthis.handlebarsKind = States.HTML;\n\t\t\t\t\treturn { type: handlebarsTokenTypes.EMBED };\n\t\t\t\t}\n\t\t\t\telse if (this.handlebarsKind === States.UnescapedExpression &&stream.advanceIfString('}}}').length > 0) {\n\t\t\t\t\tthis.handlebarsKind = States.HTML;\n\t\t\t\t\treturn { type: handlebarsTokenTypes.EMBED_UNESCAPED };\n\t\t\t\t}\n\t\t\t\telse if(stream.skipWhitespace().length > 0) {\n\t\t\t\t\treturn { type: ''};\n\t\t\t\t}\n\n\t\t\t\tif(stream.peek() === '#') {\n\t\t\t\t\tstream.advanceWhile(/^[^\\s}]/);\n\t\t\t\t\treturn { type: handlebarsTokenTypes.KEYWORD };\n\t\t\t\t}\n\n\t\t\t\tif(stream.peek() === '/') {\n\t\t\t\t\tstream.advanceWhile(/^[^\\s}]/);\n\t\t\t\t\treturn { type: handlebarsTokenTypes.KEYWORD };\n\t\t\t\t}\n\n\t\t\t\tif(stream.advanceIfString('else')) {\n\t\t\t\t\tvar next = stream.peek();\n\t\t\t\t\tif(next === ' ' || next === '\\t' || next === '}') {\n\t\t\t\t\t\treturn { type: handlebarsTokenTypes.KEYWORD };\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tstream.goBack(4);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(stream.advanceWhile(/^[^\\s}]/).length > 0) {\n\t\t\t\t\treturn { type: handlebarsTokenTypes.VARIABLE };\n\t\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\treturn super.tokenize(stream);\n\t}\n}\n\nexport class HandlebarsMode extends htmlMode.HTMLMode<htmlWorker.HTMLWorker> {\n\n\tpublic static LANG_CONFIG:LanguageConfiguration = {\n\t\twordPattern: createWordRegExp('#-?%'),\n\n\t\tcomments: {\n\t\t\tblockComment: ['<!--', '-->']\n\t\t},\n\n\t\tbrackets: [\n\t\t\t['<!--', '-->'],\n\t\t\t['{{', '}}']\n\t\t],\n\n\t\t__electricCharacterSupport: {\n\t\t\tembeddedElectricCharacters: ['*', '}', ']', ')']\n\t\t},\n\n\t\tautoClosingPairs: [\n\t\t\t{ open: '{', close: '}' },\n\t\t\t{ open: '[', close: ']' },\n\t\t\t{ open: '(', close: ')' },\n\t\t\t{ open: '\"', close: '\"' },\n\t\t\t{ open: '\\'', close: '\\'' }\n\t\t],\n\n\t\tsurroundingPairs: [\n\t\t\t{ open: '<', close: '>' },\n\t\t\t{ open: '\"', close: '\"' },\n\t\t\t{ open: '\\'', close: '\\'' }\n\t\t],\n\n\t\tonEnterRules: [\n\t\t\t{\n\t\t\t\tbeforeText: new RegExp(`<(?!(?:${htmlMode.EMPTY_ELEMENTS.join('|')}))(\\\\w[\\\\w\\\\d]*)([^/>]*(?!/)>)[^<]*$`, 'i'),\n\t\t\t\tafterText: /^<\\/(\\w[\\w\\d]*)\\s*>$/i,\n\t\t\t\taction: { indentAction: modes.IndentAction.IndentOutdent }\n\t\t\t},\n\t\t\t{\n\t\t\t\tbeforeText: new RegExp(`<(?!(?:${htmlMode.EMPTY_ELEMENTS.join('|')}))(\\\\w[\\\\w\\\\d]*)([^/>]*(?!/)>)[^<]*$`, 'i'),\n\t\t\t\taction: { indentAction: modes.IndentAction.Indent }\n\t\t\t}\n\t\t],\n\t};\n\n\tconstructor(\n\t\tdescriptor:modes.IModeDescriptor,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IModeService modeService: IModeService,\n\t\t@ICompatWorkerService compatWorkerService: ICompatWorkerService\n\t) {\n\t\tsuper(descriptor, instantiationService, modeService, compatWorkerService);\n\t}\n\n\tprotected _registerSupports(): void {\n\t\tmodes.SuggestRegistry.register(this.getId(), {\n\t\t\ttriggerCharacters: ['.', ':', '<', '\"', '=', '/'],\n\t\t\tshouldAutotriggerSuggest: true,\n\t\t\tprovideCompletionItems: (model, position, token): Thenable<modes.ISuggestResult[]> => {\n\t\t\t\treturn wireCancellationToken(token, this._provideCompletionItems(model.uri, position));\n\t\t\t}\n\t\t}, true);\n\n\t\tmodes.DocumentHighlightProviderRegistry.register(this.getId(), {\n\t\t\tprovideDocumentHighlights: (model, position, token): Thenable<modes.DocumentHighlight[]> => {\n\t\t\t\treturn wireCancellationToken(token, this._provideDocumentHighlights(model.uri, position));\n\t\t\t}\n\t\t}, true);\n\n\t\tmodes.LinkProviderRegistry.register(this.getId(), {\n\t\t\tprovideLinks: (model, token): Thenable<modes.ILink[]> => {\n\t\t\t\treturn wireCancellationToken(token, this._provideLinks(model.uri));\n\t\t\t}\n\t\t}, true);\n\n\t\tLanguageConfigurationRegistry.register(this.getId(), HandlebarsMode.LANG_CONFIG);\n\t}\n\n\tpublic getInitialState() : modes.IState {\n\t\treturn new HandlebarsState(this, htmlMode.States.Content, States.HTML, '', '', '', '', '');\n\t}\n\n\tpublic getLeavingNestedModeData(line:string, state:modes.IState):ILeavingNestedModeData {\n\t\tvar leavingNestedModeData = super.getLeavingNestedModeData(line, state);\n\t\tif (leavingNestedModeData) {\n\t\t\tleavingNestedModeData.stateAfterNestedMode = new HandlebarsState(this, htmlMode.States.Content, States.HTML, '', '', '', '', '');\n\t\t}\n\t\treturn leavingNestedModeData;\n\t}\n}\n"]}